---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

export let title: string;
export let description: string;

const siteUrl = 'https://www.rantique.com';
const twitterHandle = 'https://twitter.com/YourTwitterHandle'; // Update or remove if none
const gaMeasurementId = 'G-XXXXXXXXXX'; // Replace when ready

// Helper: Return JSON-LD for social links only if twitterHandle is set and valid
const sameAsLinks = twitterHandle && twitterHandle.trim() !== ''
  ? [`"${twitterHandle}"`]
  : [];
---

<html lang="en" class="scroll-smooth antialiased">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={description || 'Explore insights, stories, and perspectives with style.'} />
    <meta name="theme-color" content="#1A1A2E" />

    <!-- Canonical URL -->
    <link rel="canonical" href={siteUrl + Astro.request.url.pathname} />

    <!-- Open Graph -->
    <meta property="og:title" content={title || 'Rantique — A Boutique of Insightful Ideas'} />
    <meta property="og:description" content={description || 'Explore insights, stories, and perspectives with style.'} />
    <meta property="og:type" content="website" />
    <meta property="og:image" content={`${siteUrl}/og-cover.png`} />
    <meta property="og:url" content={siteUrl + Astro.request.url.pathname} />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title || 'Rantique — A Boutique of Insightful Ideas'} />
    <meta name="twitter:description" content={description || 'Explore insights, stories, and perspectives with style.'} />
    <meta name="twitter:image" content={`${siteUrl}/og-cover.png`} />

    <title>{title ? `${title} | Rantique` : 'Rantique — A Boutique of Insightful Ideas'}</title>

    <!-- Favicons -->
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="alternate icon" href="/favicon.ico" />

    <!-- Styles & Fonts -->
    <link rel="stylesheet" href="/styles/global.css" />
    <link rel="preload" href="/fonts/Inter.woff2" as="font" type="font/woff2" crossorigin />
    <link rel="preload" href="/og-cover.png" as="image" type="image/png" />

    <!-- Alpine.js -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

    <!-- MailerLite (optional) -->
    <script>
      (function(w,d,e,u,f,l,n){
        w[f]=w[f]||function(){(w[f].q=w[f].q||[]).push(arguments);};
        l=d.createElement(e);l.async=1;l.src=u;
        n=d.getElementsByTagName(e)[0];n.parentNode.insertBefore(l,n);
      })(window,document,'script','https://assets.mailerlite.com/js/universal.js','ml');
      ml('account', '1638775');
    </script>

    <!-- Google Analytics (optional) -->
    <!-- 
    <script async src={`https://www.googletagmanager.com/gtag/js?id=${gaMeasurementId}`}></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '${gaMeasurementId}', { page_path: window.location.pathname });
    </script>
    -->

    <!-- JSON-LD for SEO -->
    <script type="application/ld+json">
      {JSON.stringify({
        "@context": "https://schema.org",
        "@graph": [
          {
            "@type": "Organization",
            "@id": `${siteUrl}/#organization`,
            "name": "Rantique",
            "url": siteUrl,
            "logo": {
              "@type": "ImageObject",
              "url": `${siteUrl}/favicon-32x32.png`
            },
            ...(sameAsLinks.length > 0 && { "sameAs": sameAsLinks }),
          },
          {
            "@type": "WebSite",
            "@id": `${siteUrl}/#website`,
            "url": siteUrl,
            "name": "Rantique",
            "publisher": {
              "@id": `${siteUrl}/#organization`
            },
            "potentialAction": {
              "@type": "SearchAction",
              "target": `${siteUrl}/search?q={search_term_string}`,
              "query-input": "required name=search_term_string"
            }
          },
          {
            "@type": "WebPage",
            "@id": `${siteUrl}/#webpage`,
            "url": siteUrl + Astro.request.url.pathname,
            "name": title || "Rantique — A Boutique of Insightful Ideas",
            "isPartOf": {
              "@id": `${siteUrl}/#website`
            },
            "about": {
              "@id": `${siteUrl}/#organization`
            },
            "description": description || "Explore insights, stories, and perspectives with style."
          }
        ]
      })}
    </script>
  </head>

  <body class="bg-[#FAFAFA] text-[#2E2E2E] dark:bg-[#0F0F1A] dark:text-gray-200 font-sans">
    <Header />
    <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <slot />
    </main>
    <Footer />
  </body>
</html>

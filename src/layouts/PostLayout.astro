---
import BaseLayout from './BaseLayout.astro';
import { slugify } from '../utils/slugify';
import type { AstroComponentFactory } from 'astro';

export let title: string;
export let description: string;
export let pubDate: Date;
export let tags: string[] = [];
export let Content: AstroComponentFactory;
export let contentType: 'blog' | 'fiction' = 'blog';
export let subtitle: string | undefined;

const formattedDate = pubDate.toLocaleDateString(undefined, {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<BaseLayout {title} {description}>
  <article 
    class={`prose prose-lg max-w-3xl mx-auto dark:prose-invert ${
      contentType === 'fiction' ? 'font-serif' : ''
    }`}
  >
    <header class="mb-8 text-center">
      <h1 class="text-4xl font-extrabold leading-tight">{title}</h1>

      {subtitle && contentType === 'fiction' && (
        <p class="text-lg italic text-gray-600 dark:text-gray-400 mt-2">{subtitle}</p>
      )}

      {contentType === 'blog' && (
        <time class="text-gray-500 dark:text-gray-400 text-sm" dateTime={pubDate.toISOString()}>
          {formattedDate}
        </time>
      )}

      {tags.length > 0 && (
        <nav aria-label="Post tags" class="mt-4 space-x-2">
          {tags.map(tag => (
            <a
              href={`/tags/${slugify(tag)}/`}
              class="inline-block bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300 px-3 py-1 rounded text-xs font-medium hover:bg-gray-300 dark:hover:bg-gray-600 transition"
              rel="noopener noreferrer"
            >
              #{tag}
            </a>
          ))}
        </nav>
      )}
    </header>

    <Content />
  </article>
</BaseLayout>

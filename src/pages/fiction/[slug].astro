---
import { getEntryBySlug } from "astro:content";
import PostLayout from "../../layouts/PostLayout.astro";

export async function getStaticPaths() {
  const posts = (await import.meta.glob("../../content/fiction/*.md", { eager: true }));
  return Object.keys(posts).map((path) => {
    const slug = path.split("/").pop().replace(".md", "");
    return { params: { slug } };
  });
}

export async function get({ params }) {
  const { slug } = params;
  const post = await getEntryBySlug("fiction", slug);

  if (!post) {
    return {
      status: 404,
      body: "Post not found",
    };
  }

  return {
    props: { post },
  };
}
---

<PostLayout 
  title={post.data.title} 
  pubDate={new Date(post.data.date)} 
  contentType="fiction"
  Content={post.Content}
  subtitle={post.data.subtitle}
  tags={post.data.tags ?? []}
>
</PostLayout>
